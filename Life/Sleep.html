<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Advanced Sleep Calculator ‚Äì World Class</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --primary:#4f46e5;
  --bg:#f4f6fb;
  --card:#ffffff;
  --radius:14px;
  --text:#1f2937;
  --muted:#6b7280;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui,Arial;
  background:var(--bg);
  color:var(--text);
}
.container{max-width:980px;margin:auto;padding:16px}
.card{
  background:var(--card);
  border-radius:var(--radius);
  box-shadow:0 12px 28px rgba(0,0,0,.08);
  margin-bottom:22px;
  padding:20px;
}
h1,h3{margin:0;color:var(--primary)}
small{color:var(--muted)}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:14px;
}
label{font-size:14px;margin-bottom:6px;display:block}
input, select{
  width:100%;height:48px;padding:10px 12px;
  border-radius:10px;border:1px solid #d1d5db;font-size:15px;
}
button{
  margin-top:14px;width:100%;height:52px;
  background:var(--primary);color:#fff;border:none;
  border-radius:12px;font-size:16px;cursor:pointer;
}
.result{
  margin-top:16px;background:#f9fafb;
  border-radius:12px;padding:16px;line-height:1.7;
}
.tag{
  display:inline-block;padding:4px 10px;border-radius:999px;
  background:#eef2ff;color:#3730a3;font-size:13px;margin:4px 6px 4px 0;
}
</style>
</head>

<body>
<div class="container">

<!-- HEADER -->
<div class="card">
<h1>Advanced Sleep Calculator</h1>
<small>Sleep cycles ¬∑ Age needs ¬∑ Consistency ¬∑ Health insights</small>
</div>

<!-- SLEEP CYCLES -->
<div class="card">
<h3>‚è∞ Sleep Cycle Calculator</h3>
<div class="grid">
<div>
<label>I want to</label>
<select id="mode">
<option value="wake">Wake up at</option>
<option value="bed">Go to bed at</option>
</select>
</div>
<div>
<label>Target Time</label>
<input type="time" id="targetTime">
</div>
<div>
<label>Sleep Latency (minutes)</label>
<select id="latency">
<option value="10">10</option>
<option value="15" selected>15</option>
<option value="20">20</option>
<option value="30">30</option>
</select>
</div>
</div>
<button onclick="calcCycles()">Calculate Sleep Times</button>
<div class="result" id="cycleRes">‚Äî</div>
</div>

<!-- AGE BASED -->
<div class="card">
<h3>üß¨ Age-Based Sleep Needs</h3>
<div class="grid">
<div><label>Age</label><input id="ageInput" type="number"></div>
<div><label>Avg Sleep (hrs/night)</label><input id="avgSleepInput" type="number" step="0.1"></div>
</div>
<button onclick="calcAgeSleep()">Analyze Sleep Need</button>
<div class="result" id="ageResult">‚Äî</div>
</div>

<!-- CONSISTENCY -->
<div class="card">
<h3>üìÖ 7-Day Sleep Consistency Tracker</h3>
<div class="grid">
<input type="time" class="mid"><input type="time" class="mid">
<input type="time" class="mid"><input type="time" class="mid">
<input type="time" class="mid"><input type="time" class="mid">
<input type="time" class="mid">
</div>
<button onclick="calcWeekly()">Calculate Weekly Consistency</button>
<div class="result" id="weekResult">‚Äî</div>
</div>

</div>

<script>
const pad=n=>String(n).padStart(2,"0");
const toMin=t=>{const[h,m]=t.split(":").map(Number);return h*60+m};
const fromMin=m=>`${pad(Math.floor(m/60)%24)}:${pad(m%60)}`;

// Sleep cycles
function calcCycles(){
  const time=document.getElementById("targetTime").value;
  if(!time){cycleRes.innerHTML="Please select a time";return;}
  const mode=document.getElementById("mode").value;
  const latency=+document.getElementById("latency").value;
  const base=toMin(time);
  let html="";
  for(let c=6;c>=3;c--){
    let t=(mode==="wake"?base-(c*90+latency):base+(c*90+latency)+1440)%1440;
    html+=`<span class="tag">${fromMin(t)}</span> (${c} cycles)<br>`;
  }
  cycleRes.innerHTML=html;
}

// Age-based
function calcAgeSleep(){
  const age=+document.getElementById("ageInput").value;
  const avg=+document.getElementById("avgSleepInput").value;
  if(!age||!avg){ageResult.innerHTML="Please enter age and sleep hours";return;}
  let min,max;
  if(age<=12){min=9;max=12}
  else if(age<=18){min=8;max=10}
  else if(age<=64){min=7;max=9}
  else{min=7;max=8}
  let status=avg<min?"Sleep Deficit ‚ùå":avg>max?"Oversleeping ‚ö†Ô∏è":"Optimal Sleep ‚úÖ";
  ageResult.innerHTML=`
  <span class="tag">${min}‚Äì${max} hrs recommended</span>
  <span class="tag">${status}</span><br><br>
  Your sleep: ${avg} hrs/night<br>
  Recommendation: ${status==="Optimal Sleep ‚úÖ"?"Maintain routine":"Adjust duration"}
  `;
}

// Consistency (scientific)
function calcWeekly(){
  const vals=[...document.querySelectorAll(".mid")].map(i=>i.value).filter(Boolean);
  if(vals.length<4){weekResult.innerHTML="Enter at least 4 days";return;}
  const mins=vals.map(toMin);
  const mean=mins.reduce((a,b)=>a+b,0)/mins.length;
  const deviations=mins.map(m=>{
    let d=Math.abs(m-mean);
    return Math.min(d,1440-d);
  });
  const avgDev=deviations.reduce((a,b)=>a+b,0)/deviations.length;
  let score=Math.round(100-(avgDev/60)*10);
  score=Math.max(0,Math.min(100,score));
  let label=score>=85?"Excellent üü¢":score>=70?"Good üü°":score>=50?"Poor üî¥":"Very Irregular ‚ùå";
  weekResult.innerHTML=`
  <span class="tag">Consistency ${score}/100</span>
  <span class="tag">${label}</span><br><br>
  Avg deviation: ${avgDev.toFixed(0)} min<br>
  Insight: ${score>=80?"Stable circadian rhythm":"Improve bedtime regularity"}
  `;
}
</script>

</body>
</html>
