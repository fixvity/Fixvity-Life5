<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Advanced Sleep Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --primary:#4f46e5;
  --bg:#f4f6fb;
  --card:#ffffff;
  --radius:14px;
  --text:#1f2937;
  --muted:#6b7280;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui,Arial;
  background:var(--bg);
  color:var(--text);
}
.container{max-width:950px;margin:auto;padding:16px}
.card{
  background:var(--card);
  border-radius:var(--radius);
  box-shadow:0 12px 28px rgba(0,0,0,.08);
  margin-bottom:22px;
  padding:20px;
}
h1{margin:0;color:var(--primary)}
small{color:var(--muted)}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:14px;
}
label{font-size:14px;margin-bottom:6px;display:block}
input, select{
  width:100%;height:48px;padding:10px 12px;
  border-radius:10px;border:1px solid #d1d5db;font-size:15px;
}
button{
  margin-top:14px;width:100%;height:52px;
  background:var(--primary);color:#fff;border:none;
  border-radius:12px;font-size:16px;cursor:pointer;
}
.result{
  margin-top:16px;background:#f9fafb;
  border-radius:12px;padding:16px;line-height:1.7;
}
.tag{
  display:inline-block;padding:4px 10px;border-radius:999px;
  background:#eef2ff;color:#3730a3;font-size:13px;margin:4px 6px 4px 0;
}
</style>
</head>

<body>
<div class="container">

<!-- HEADER -->
<div class="card">
<h1>Advanced Sleep Calculator</h1>
<small>Sleep cycles ¬∑ Age needs ¬∑ 7-day consistency ¬∑ Health insights</small>
</div>

<!-- AGE BASED -->
<div class="card">
<h3>üß¨ Age-Based Sleep Needs</h3>
<div class="grid">
<div>
<label>Age</label>
<input id="age" type="number" placeholder="Years">
</div>
<div>
<label>Average Sleep (hours/night)</label>
<input id="avgSleep" type="number" step="0.1" placeholder="e.g. 7.5">
</div>
</div>
<button onclick="calcAgeSleep()">Analyze Sleep Need</button>
<div class="result" id="ageResult">‚Äî</div>
</div>

<!-- 7 DAY TRACKER -->
<div class="card">
<h3>üìÖ 7-Day Sleep Consistency Tracker</h3>

<div class="grid">
<div><label>Day 1 Midpoint (HH:MM)</label><input type="time" class="mid"></div>
<div><label>Day 2 Midpoint</label><input type="time" class="mid"></div>
<div><label>Day 3 Midpoint</label><input type="time" class="mid"></div>
<div><label>Day 4 Midpoint</label><input type="time" class="mid"></div>
<div><label>Day 5 Midpoint</label><input type="time" class="mid"></div>
<div><label>Day 6 Midpoint</label><input type="time" class="mid"></div>
<div><label>Day 7 Midpoint</label><input type="time" class="mid"></div>
</div>

<button onclick="calcWeekly()">Calculate Weekly Consistency</button>
<div class="result" id="weekResult">‚Äî</div>
</div>

</div>

<script>
function calcAgeSleep(){
  const age = +document.getElementById("age").value;
  const avg = +document.getElementById("avgSleep").value;
  if(!age || !avg){ ageResult.innerHTML="‚Äî"; return; }

  let min,max;
  if(age <=12){min=9;max=12}
  else if(age<=18){min=8;max=10}
  else if(age<=64){min=7;max=9}
  else{min=7;max=8}

  let status;
  if(avg < min) status = "Sleep Deficit ‚ùå";
  else if(avg > max) status = "Oversleeping ‚ö†Ô∏è";
  else status = "Optimal Sleep ‚úÖ";

  ageResult.innerHTML = `
  <span class="tag">${min}‚Äì${max} hrs recommended</span>
  <span class="tag">${status}</span><br><br>
  <strong>Your Sleep:</strong> ${avg} hrs/night<br>
  <strong>Recommendation:</strong>
  ${status==="Optimal Sleep ‚úÖ"
    ?"Maintain your routine."
    :"Adjust bedtime to reach recommended range."}
  `;
}

function calcWeekly(){
  const times=[...document.querySelectorAll(".mid")]
    .map(i=>i.value).filter(v=>v);

  if(times.length < 4){
    weekResult.innerHTML="Enter at least 4 days";
    return;
  }

  const minutes = times.map(t=>{
    const [h,m]=t.split(":").map(Number);
    return h*60+m;
  });

  const avg = minutes.reduce((a,b)=>a+b,0)/minutes.length;
  const dev = minutes.map(v=>Math.abs(v-avg));
  const avgDev = dev.reduce((a,b)=>a+b,0)/dev.length;

  let score = Math.max(0, Math.round(100 - (avgDev/30)*5));
  let label =
    score>=90?"Excellent üü¢":
    score>=75?"Good üü°":
    score>=50?"Poor üî¥":"Very Irregular ‚ùå";

  weekResult.innerHTML = `
  <span class="tag">Consistency ${score}/100</span>
  <span class="tag">${label}</span><br><br>
  <strong>Average Midpoint Deviation:</strong> ${avgDev.toFixed(0)} min<br>
  <strong>Insight:</strong>
  ${score>=80
    ?"Your sleep timing is stable."
    :"Improve by sleeping within ¬±30 min daily."}
  `;
}
</script>

</body>
</html>
